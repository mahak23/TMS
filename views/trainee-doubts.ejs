<div class="container">
    <div class="form-group">
        <form id='message-form'>
            <input name='message' id="message" type="text" placeholder="Message" autofocus autocomplete="off" />
    </div>
    <button type="submit" id="btn" name="submitbtn" class="btn btn-primary">
        Send
    </button>
    </form>
    <ul id="messages"></ul>
</div>

<script src="/socket.io/socket.io.js"></script>
<script src="js/jquery.js"></script>
<script>
    const server = "http://localhost:4000";
    const socket = io();
    let message = document.getElementById('message');
    let btn = document.getElementById('btn');

    btn.addEventListener('click', function () {
        socket.emit('createMessage', message.value);
    });

    $.ajax({
        url: server + "/chat",
        method: "GET",
        success: function (response) {
            console.log(response);
            var messages = document.getElementById("messages");
            const data = JSON.parse(response);
            for (const a = 0; a < data; a++) {
                var li = document.createElement("li");
                li.innerHTML = data;
                messages.appendChild(li);
            }
        }
    })


    socket.on('createMessage', function (data) {
        console.log(data);
        var li = document.createElement("li");
        li.innerHTML = data;
        var messages = document.getElementById("messages");
        messages.appendChild(li);
    })

</script>